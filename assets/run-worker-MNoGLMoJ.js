const l=new TextEncoder,w=new TextDecoder;let e=null,n=null;async function y(){if(e)return;const t=await(await fetch(new URL("/wren-lsp/assets/wren-runner-OpoMoWLS.wasm",import.meta.url))).arrayBuffer(),s=(await import("./index-DLpwg0kr.js")).WASI,r=[{fd_write:()=>{throw new Error("stdio write is not supported")},fd_read:()=>{throw new Error("stdio read is not supported")}},{fd_write:()=>{throw new Error("stdio write is not supported")},fd_read:()=>{throw new Error("stdio read is not supported")}},{fd_write:()=>{throw new Error("stdio write is not supported")},fd_read:()=>{throw new Error("stdio read is not supported")}}];n=new s(["wren-runner.wasm"],[],r,{debug:!1});const{instance:o}=await WebAssembly.instantiate(t,{wasi_snapshot_preview1:n.wasiImport});n.inst=o,e=o.exports}self.addEventListener("message",async a=>{const{token:t,source:s}=a.data;try{await y();const r=l.encode(s),o=e.allocSource(r.length);new Uint8Array(e.memory.buffer).set(r,o);const c=e.runCode(),u=e.getOutputPtr(),d=e.getOutputLen(),p=d>0?w.decode(new Uint8Array(e.memory.buffer,u,d)):"",f=e.getErrorPtr(),i=e.getErrorLen(),m=i>0?w.decode(new Uint8Array(e.memory.buffer,f,i)):"";postMessage({token:t,output:p,errors:m,result:c})}catch(r){postMessage({token:t,output:"",errors:r instanceof Error?r.message:String(r),result:2})}});
